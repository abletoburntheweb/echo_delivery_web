<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ö–∞–ª–µ–Ω–¥–∞—Ä—å | ECHO Corp.</title>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'core/css/calendar.css' %}">
</head>
<body>
    <div class="header">
    <span class="header-title">ECHO Corp.</span>
    <a href="{% url 'profile' %}" class="profile-button">üë§</a>
</div>
    <div class="main-content">
        <div class="container">
            <div class="calendar-header">
    <h2 class="month-header">{{ month_name|capfirst }}</h2>
    <a href="{% url 'faq' %}" class="faq-button">FAQ</a>
</div>
            <div class="weekdays-grid">
                <div class="weekday">–ü–Ω</div>
                <div class="weekday">–í—Ç</div>
                <div class="weekday">–°—Ä</div>
                <div class="weekday">–ß—Ç</div>
                <div class="weekday">–ü—Ç</div>
                <div class="weekday">–°–±</div>
                <div class="weekday">–í—Å</div>
            </div>
            <div class="calendar-grid">
                {% for i in "0123456"|make_list %}
                    {% if i|add:"0" < days.0.weekday %}
                        <div class="empty-cell"></div>
                    {% endif %}
                {% endfor %}
                {% for day_info in days %}
                    <div class="day-btn{% if day_info.is_today %} selected{% endif %}" data-date="{{ day_info.date|date:'Y-m-d' }}">{{ day_info.date.day }}</div>
                {% endfor %}
            </div>
            <form id="calendar-form" method="post">
                {% csrf_token %}
                <input type="hidden" id="selected-date" name="selected_date" value="">
                <button class="accept-button" type="submit">–ü—Ä–∏–Ω—è—Ç—å</button>
            </form>
        </div>
    </div>

   <script>
    document.addEventListener('DOMContentLoaded', function() {
        const dayButtons = document.querySelectorAll('.day-btn');
        const selectedDateInput = document.getElementById('selected-date');
        let selectedButton = null;

        function selectDay(button) {
            // –°–Ω–∏–º–∞–µ–º –∫–ª–∞—Å—Å selected —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            dayButtons.forEach(btn => btn.classList.remove('selected'));

            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å selected –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–µ
            button.classList.add('selected');
            selectedButton = button;

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É –≤ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ —Ñ–æ—Ä–º—ã
            const dateValue = button.getAttribute('data-date');
            selectedDateInput.value = dateValue;
            console.log('–í—ã–±—Ä–∞–Ω–∞ –¥–∞—Ç–∞:', dateValue);
        }

        dayButtons.forEach(button => {
            button.addEventListener('click', function() {
                selectDay(this);
            });
        });

        if (selectedDateInput.value) {
            // –ï—Å–ª–∏ –µ—Å—Ç—å, –Ω–∞—Ö–æ–¥–∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É –∏ "–≤—ã–±–∏—Ä–∞–µ–º" –µ—ë
            const previouslySelectedButton = document.querySelector(`.day-btn[data-date="${selectedDateInput.value}"]`);
            if (previouslySelectedButton) {
                selectDay(previouslySelectedButton);
            }
        } else {
            // –ï—Å–ª–∏ –Ω–µ—Ç, –≤—ã–±–∏—Ä–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
            const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
            const todayButton = document.querySelector(`.day-btn[data-date="${today}"]`);
            if (todayButton) {
                selectDay(todayButton);
            }
        }
    });
</script>
</body>
</html>